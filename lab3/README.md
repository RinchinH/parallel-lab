# ЛР-3. Решение СЛАУ итерационными методами (Jacobi, CUDA)

## Постановка
Решаем `A x = b` методом Якоби для матрицы:
- `A[i,i] = 2N + 1`, `A[i,j] = 1` при `i ≠ j`.
- Генерируем `x_true`, считаем `b = A x_true`, затем восстанавливаем `x`.

## Реализация CUDA
`lab3/cuda/jacobi_cuda.cu`.

Используется быстрый вариант за счёт структуры матрицы:
- `sum_x = Σ x_j`
- `x^{k+1}_i = (b_i - (sum_x - x_i)) / (2N + 1)`
- `r_i = (2N)*x_i + sum_x - b_i`

Останов: `||A x − b||2 / ||b||2 < eps` или `k >= maxit`.

## Два варианта нормы невязки 
1) **atomic**: `Σ r_i^2` суммируется на GPU через `atomicAdd` в глобальной памяти.
2) **host**: на каждой итерации `x_new` копируется на хост, норма считается на CPU, затем решаем продолжать/остановиться.

## Сборка
```bash
make -C lab3/cuda
```

## Прогон и результаты
```bash
bash lab3/scripts/run_cuda.sh 1000000 1e-8 10000 256
# output: lab3/results/timings.csv
```


atomic (atomicAdd)
| Потоки | N         | Время, s  | Ускорение S | Эффективность, % |
| ------ | --------- | --------- | ----------- | ---------------- |
| 64     | 1 000 000 | 0.0402014 | 1.00        | 100.0            |
| 128    | 1 000 000 | 0.0399836 | 1.01        | 50.3             |
| 256    | 1 000 000 | 0.0400395 | 1.00        | 25.1             |
| 512    | 1 000 000 | 0.0399697 | 1.01        | 12.6             |
| 1024   | 1 000 000 | 0.0400858 | 1.00        | 6.3              |

host (копирование на CPU + суммирование на хосте)

| Потоки | N         | Время, s | Ускорение S | Эффективность, % |
| ------ | --------- | -------- | ----------- | ---------------- |
| 64     | 1 000 000 | 0.12215  | 1.00        | 100.0            |
| 128    | 1 000 000 | 0.121571 | 1.00        | 50.2             |
| 256    | 1 000 000 | 0.125877 | 0.97        | 24.3             |
| 512    | 1 000 000 | 0.123023 | 0.99        | 12.4             |
| 1024   | 1 000 000 | 0.122288 | 1.00        | 6.2              |




